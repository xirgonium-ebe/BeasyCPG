<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alfresco Generator – Model / Forms / DynLists</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>Alfresco/beCPG – Générateur de balises & imports</h1>
    <div class="header-actions">
      <button id="btnExportJSON" class="btn">Exporter projet (.json)</button>
      <label class="file-label">
        Importer projet (.json)
        <input type="file" id="fileImportJSON" accept=".json" />
      </label>
      <button id="btnReset" class="btn btn-danger">Réinitialiser</button>
    </div>
  </header>

  <nav class="tabs">
    <button data-tab="project" class="tab active">Projet</button>
    <button data-tab="properties" class="tab">Propriétés</button>
    <button data-tab="assocs" class="tab">Associations</button>
    <button data-tab="dynlists" class="tab">DynLists</button>
    <button data-tab="preview" class="tab">Aperçu & Export</button>
  </nav>

  <main>
    <!-- PROJECT -->
    <section id="tab-project" class="panel active">
      <form id="formProject" class="form-grid">
        <fieldset>
          <legend>Infos projet</legend>
          <label>
            Nom du projet
            <input name="projectName" placeholder="ex: My project" />
          </label>
          <label>
            Namespace prefix
            <input name="nsPrefix" placeholder="ex: ebe" />
          </label>
          <label>
            Namespace URI
            <input name="nsUri" placeholder="ex: http://example.com/ebe/1.0" />
          </label>
        </fieldset>

        <fieldset>
          <legend>Paramètres généraux</legend>
          <label>
            QName contrainte DynList
            <input name="dynQName" value="bcpg:dynListConstraint" />
          </label>
          <label>
            Nom du paramètre “chemin de liste”
            <input name="dynPathParam" value="list-path" />
          </label>
          <label>
            Locale par défaut
            <input name="defaultLocale" value="fr" />
          </label>
          <label class="check">
            <input type="checkbox" name="includeContainers" checked />
            Inclure les balises conteneurs (&lt;properties&gt;, &lt;associations&gt;, &lt;constraints&gt;)
          </label>
        </fieldset>

        <fieldset>
          <legend>Conteneur de définitions</legend>
          <div class="inline">
            <label class="check">
              <input type="checkbox" name="containerProperties" checked />
              Générer des propriétés
            </label>
            <label class="check">
              <input type="checkbox" name="containerAssociations" checked />
              Générer des associations
            </label>
          </div>
        </fieldset>

        <div class="row-actions">
          <button type="submit" class="btn btn-primary">Enregistrer</button>
        </div>
      </form>
    </section>

    <!-- PROPERTIES -->
    <section id="tab-properties" class="panel">
      <form id="formProperty" class="form-grid">
        <fieldset>
          <legend><span id="propFormLegend">Nouvelle propriété</span></legend>
          <div class="grid-3">
            <label>
              Nom technique (local)
              <input name="qnameLocal" placeholder="ex: myProp" required />
            </label>
            <label>
              Title (libellé)
              <input name="title" placeholder="ex: My funny property" />
            </label>
            <label>
              Type (Alfresco)
              <select name="type">
                <option>d:text</option>
                <option>d:mltext</option>
                <option>d:int</option>
                <option>d:long</option>
                <option>d:double</option>
                <option>d:boolean</option>
                <option>d:date</option>
                <option>d:datetime</option>
                <option>d:content</option>
              </select>
            </label>
          </div>

          <div class="grid-3">
            <label class="check"><input type="checkbox" name="multiple" /> Multiple</label>
            <label>
              Valeur par défaut
              <input name="default" />
            </label>
            <div></div>
          </div>

          <div class="grid-3">
            <label class="check"><input type="checkbox" name="mandatoryModel" /> Mandatory (modèle)</label>
            <label class="check"><input type="checkbox" name="mandatoryForm" /> Mandatory (form)</label>
            <label class="check"><input type="checkbox" name="readOnlyForm" /> Read-only (form)</label>
          </div>
        </fieldset>

        <fieldset>
          <legend>Contrainte (optionnelle)</legend>
          <div class="grid-3">
            <label>
              Nom de la contrainte
              <input name="constraintName" placeholder="ex: brn:goDecisionList" />
            </label>
            <label>
              Type de contrainte
              <input name="constraintType" value="bcpg:dynListConstraint" />
            </label>
            <label>
              Chemin de la liste (DynList)
              <input name="dynPath" placeholder="/app:company_home/cm:System/cm:Lists/bcpg:entityLists/cm:ma_liste" />
            </label>
          </div>
        </fieldset>

        <div class="row-actions">
          <button type="submit" class="btn btn-primary" id="btnSaveProp">Ajouter propriété</button>
          <button type="button" class="btn" id="btnCancelProp" style="display:none">Annuler</button>
        </div>
      </form>

      <div class="list">
        <h3>Propriétés</h3>
        <table id="tblProperties" class="table">
          <thead>
            <tr>
              <th>QName</th><th>Title</th><th>Type</th><th>Multi</th><th>Def</th><th>Mand(M)</th><th>Mand(F)</th><th>RO(F)</th><th>Constraint</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- ASSOCIATIONS -->
    <section id="tab-assocs" class="panel">
      <form id="formAssoc" class="form-grid">
        <fieldset>
          <legend><span id="assocFormLegend">Nouvelle association</span></legend>
          <div class="grid-3">
            <label>
              Nom technique (local)
              <input name="qnameLocal" placeholder="ex: myAssoc" required />
            </label>
            <label>
              Title
              <input name="title" placeholder="ex: My lovely association" />
            </label>
            <label>
              Classe cible
              <input name="targetClass" value="cm:person" />
            </label>
          </div>
          <div class="grid-3">
            <label class="check"><input type="checkbox" name="mandatoryModel" /> Mandatory (modèle)</label>
            <label class="check"><input type="checkbox" name="mandatoryForm" /> Mandatory (form)</label>
            <div></div>
          </div>
          <div class="grid-3">
            <label>Source many
              <select name="sourceMany">
                <option value="true" selected>true</option>
                <option value="false">false</option>
              </select>
            </label>
            <label>Target many
              <select name="targetMany">
                <option value="false" selected>false</option>
                <option value="true">true</option>
              </select>
            </label>
            <div></div>
          </div>
        </fieldset>
        <div class="row-actions">
          <button type="submit" class="btn btn-primary" id="btnSaveAssoc">Ajouter association</button>
          <button type="button" class="btn" id="btnCancelAssoc" style="display:none">Annuler</button>
        </div>
      </form>

      <div class="list">
        <h3>Associations</h3>
        <table id="tblAssocs" class="table">
          <thead>
            <tr>
              <th>QName</th><th>Title</th><th>Target</th><th>S-many</th><th>T-many</th><th>Mand(M)</th><th>Mand(F)</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- DYNLISTS -->
    <section id="tab-dynlists" class="panel">
      <form id="formDyn" class="form-grid">
        <fieldset>
          <legend><span id="dynFormLegend">Nouvelle DynList</span></legend>
          <div class="grid-3">
            <label>Nom logique de la liste
              <input name="listName" placeholder="ex: ebe_ufoFlyingMode" required />
            </label>
            <label>Chemin dans Alfresco
              <input name="listPath" placeholder="/app:company_home/cm:System/cm:Lists/bcpg:entityLists/cm:ebe_ufoFlyingMode" required />
            </label>
            <div></div>
          </div>
          <label>
            Coller vos lignes (CSV/TSV) – colonnes supportées : code;value;locale;active;order;parent
            <textarea name="pasted" rows="8" placeholder="code;value;locale;active;order
GO;GO;fr;true;1
NO_GO;NO GO;fr;true;2"></textarea>
          </label>
          <div class="row-actions">
            <button type="button" id="btnParseDyn" class="btn">Analyser</button>
            <button type="submit" class="btn btn-primary" id="btnSaveDyn">Ajouter DynList</button>
            <button type="button" class="btn" id="btnCancelDyn" style="display:none">Annuler</button>
          </div>
        </fieldset>
      </form>

      <div class="list">
        <h3>DynLists</h3>
        <table id="tblDyn" class="table">
          <thead>
            <tr>
              <th>Nom</th><th>Chemin</th><th>Entrées</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- PREVIEW -->
    <section id="tab-preview" class="panel">
      <div class="preview-grid">
        <div class="preview-block">
          <div class="block-head">
            <h3>Fragment modèle – &lt;properties&gt;</h3>
            <button class="btn btn-copy" data-copy="#outProps">Copier</button>
          </div>
          <textarea id="outProps" rows="12" readonly></textarea>
        </div>

        <div class="preview-block">
          <div class="block-head">
            <h3>Fragment modèle – &lt;associations&gt;</h3>
            <button class="btn btn-copy" data-copy="#outAssocs">Copier</button>
          </div>
          <textarea id="outAssocs" rows="12" readonly></textarea>
        </div>

        <div class="preview-block">
          <div class="block-head">
            <h3>Fragment modèle – &lt;constraints&gt;</h3>
            <button class="btn btn-copy" data-copy="#outConstraints">Copier</button>
          </div>
          <textarea id="outConstraints" rows="12" readonly></textarea>
        </div>

        <div class="preview-block">
          <div class="block-head">
            <h3>Share – &lt;show&gt;</h3>
            <button class="btn btn-copy" data-copy="#outShow">Copier</button>
          </div>
          <textarea id="outShow" rows="10" readonly></textarea>
        </div>

        <div class="preview-block">
          <div class="block-head">
            <h3>Share – &lt;field&gt;</h3>
            <button class="btn btn-copy" data-copy="#outField">Copier</button>
          </div>
          <textarea id="outField" rows="14" readonly></textarea>
        </div>
      </div>

      <div class="export-actions">
        <button id="btnBuild" class="btn btn-primary">Construire fragments</button>
        <button id="btnDownloadZip" class="btn">Télécharger ZIP</button>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <small>Made for Alfresco/beCPG · 100% client-side</small>
  </footer>

  <script src="app.js"></script>
</body>
</html>
