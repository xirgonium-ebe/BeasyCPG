<!doctype html>
<html lang="fr">
	
<head>
  <meta charset="utf-8" />
  <title>BeasyCPG – Configurator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="./styles.css" />
  <script src="./app.js" defer></script>
</head>
<body>
  <header class="app-header">
    <h1>BeasyCPG – Générateur de configuration</h1>
    <p class="subtitle">Exemples d’entités : Jedi, Sith, Droïdes, Vaisseaux…</p>
    <div class="actions">
      <button id="btnSaveProject" class="btn primary">Enregistrer le projet</button>
      <button id="btnExportDynlistCsv" class="btn">Exporter DynLists (CSV)</button>
      <button id="btnExportDynlistJson" class="btn">Exporter DynLists (JSON)</button>
    </div>
    <div id="saveStatus" class="status" aria-live="polite"></div>
  </header>

  <main>
    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="Sections de configuration">
      <button class="tab is-active" role="tab" aria-selected="true" aria-controls="panel-projet" id="tab-projet">Projet</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="panel-model" id="tab-model">Modèle</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="panel-shows" id="tab-shows">Shows</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="panel-fields" id="tab-fields">Fields</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="panel-dynlists" id="tab-dynlists">DynLists</button>
    </div>

    <!-- Panels -->
    <section id="panel-projet" class="panel is-active" role="tabpanel" aria-labelledby="tab-projet">
      <h2>Projet</h2>
      <form id="projectForm" autocomplete="off">
        <div class="grid">
          <label>
            Nom du projet
            <input name="projectName" type="text" placeholder="[JEDI-001] Sabre laser – config" required />
          </label>
          <label>
            Code projet
            <input name="projectCode" type="text" placeholder="JEDI-001" required />
          </label>
          <label>
            Auteur
            <input name="author" type="text" placeholder="Obi-Wan Kenobi" />
          </label>
          <label>
            Commentaire
            <input name="comment" type="text" placeholder="Config initiale de tests (Star Wars)" />
          </label>
        </div>
      </form>
    </section>

    <section id="panel-model" class="panel" role="tabpanel" aria-labelledby="tab-model">
      <h2>Modèle</h2>

      <details open class="group">
        <summary>Définition du modèle</summary>
        <div class="grid">
          <label>
            ID du modèle
            <input name="model.id" type="text" placeholder="sw:lightsaber" />
          </label>
          <label>
            Titre du modèle
            <input name="model.title" type="text" placeholder="Sabre laser" />
          </label>
          <label>
            Namespace
            <input name="model.namespace" type="text" placeholder="sw" />
          </label>
          <label>
            Description
            <input name="model.description" type="text" placeholder="Modèle pour objets Star Wars" />
          </label>
        </div>
      </details>

      <details class="group">
        <summary>Associations</summary>
        <p class="hint">Exemples: porteur (Jedi), cristaux Kyber, pièces détachées…</p>
        <table class="table" id="tableAssociations">
          <thead>
            <tr>
              <th>Nom</th>
              <th>Type cible</th>
              <th>Cardinalité</th>
              <th>Obligatoire</th>
              <th>Rôle site</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- lignes dynamiques -->
          </tbody>
        </table>
        <button class="btn" data-action="add-assoc">Ajouter une association</button>
      </details>
    </section>

    <section id="panel-shows" class="panel" role="tabpanel" aria-labelledby="tab-shows">
      <h2>Shows</h2>
      <details open class="group">
        <summary>Configuration des shows (groupes d’affichage)</summary>
        <table class="table" id="tableShows">
          <thead>
            <tr>
              <th>ID</th>
              <th>Titre</th>
              <th>Description</th>
              <th>Visible (condition)</th>
              <th>Ordre</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button class="btn" data-action="add-show">Ajouter un show</button>
      </details>
    </section>

    <section id="panel-fields" class="panel" role="tabpanel" aria-labelledby="tab-fields">
      <h2>Fields</h2>
      <details open class="group">
        <summary>Champs</summary>
        <table class="table" id="tableFields">
          <thead>
            <tr>
              <th>Propriété</th>
              <th>Type</th>
              <th>Obligatoire</th>
              <th>Lecture seule</th>
              <th>Contrainte / DynList</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button class="btn" data-action="add-field">Ajouter un field</button>
      </details>
    </section>

    <section id="panel-dynlists" class="panel" role="tabpanel" aria-labelledby="tab-dynlists">
      <h2>DynLists</h2>
      <details open class="group">
        <summary>Tables des contraintes DynList</summary>
        <p class="hint">Tu peux exporter avec en-têtes personnalisés et inclure chemin + nom de DynList.</p>
        <div class="export-headers">
          <label>
            En-tête CSV (séparé par des virgules)
            <input id="dynlistHeaders" type="text" placeholder="path,name,code,label,value" />
          </label>
          <label>
            Chemin (prefix)
            <input id="dynlistPathPrefix" type="text" placeholder="/System/Lists/bcpg:entityLists/" />
          </label>
        </div>
        <table class="table" id="tableDynLists">
          <thead>
            <tr>
              <th>Nom DynList</th>
              <th>Code</th>
              <th>Label</th>
              <th>Valeur</th>
              <th>Chemin (auto)</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button class="btn" data-action="add-dynrow">Ajouter une ligne</button>
      </details>
    </section>
  </main>

  <footer class="app-footer">
    <small>© BeasyCPG – Générateur – Star Wars sample data uniquement (pas d’usage Boiron/Adisseo/ben/go)</small>
  </footer>
</body>
</html>
